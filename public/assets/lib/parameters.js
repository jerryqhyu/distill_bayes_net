param = {
    w: 984,
    h: 300,
    w_loss: 300,
    h_loss: 300,
    w_progress: 650,
    h_progress: 300,
    w_uncertain: 485,
    h_uncertain: 300,
    n: 50,
    m: 50,
    var_n: 60,
    var_m: 60,
    scaling_factor: 6,
    var_scaling_factor: 5,
    step_size: 0.1,
    learning_rate: 5e-3,
    l1_decay: 0,
    l2_decay: 0,
    momentum: 0.95,
    batch_size: 16,
    divergence_curve_domain_x: [-12, 12],
    divergence_curve_domain_y: [-0.15, 0.5],
    curve_domain_x: [
        -5, 5
    ],
    curve_domain_y: [
        -2, 2
    ],
    loss_domain_x: [
        -0.5, 2.5
    ],
    loss_domain_y: [
        -0.5, 2.5
    ],
    progress_domain_x: [
        0, 1
    ],
    progress_domain_y: [
        0, 8
    ],
    uncertain_domain_x: [
        -7.5, 7.5
    ],
    uncertain_domain_y: [
        -1.2, 1.2
    ],
    train_points: [
        0.98348382,
        0.33239784,
        1.31901198,
        -1.33424016,
        -2.49962207,
        2.671385
    ],
    train_noise: [
        -0.24911933,
        -0.18541917,
        0.37738159,
        0.16834003,
        0.39383113,
        0.37258389
    ],
    validation_points: [
        0.0074539,
        -2.25649362,
        1.2912101,
        -1.15521679,
        0.15278725,
        2.0997623,
        1.47247248,
        -1.05303993,
        0.4568989,
        -0.61385536,
        -2.18751186,
        1.26085173,
        -2.8500024,
        2.59464658,
        2.64281159,
        -2.93701525,
        0.7578316,
        2.49371189,
        2.43455803,
        -1.30204828,
        -0.72566079,
        -2.53146956,
        2.37625046,
        -1.46966588,
        -1.83330212,
        2.57031247,
        -1.91009532,
        -2.41233259,
        -0.44398402,
        1.06769911,
        2.32972244,
        -1.84966642,
        2.53616255,
        0.42077324,
        0.4261107,
        1.42198161,
        2.72728906,
        -1.71100897,
        -1.59204741,
        1.2299973,
        0.37747723,
        0.32106662,
        0.07131672,
        0.03220256,
        -1.37330352,
        1.47470907,
        2.19194335,
        -0.77412576,
        -1.29907828,
        -2.64114398
    ],
    validation_noise: [
        -0.09674867,
        0.02199221,
        0.14537768,
        -0.11992788,
        0.09587188,
        0.04348861,
        0.26443214,
        -0.04382649,
        -0.02890301,
        -0.00131674,
        0.09219836,
        0.05413551,
        0.10605215,
        0.03032372,
        0.04228423,
        0.07250382,
        0.01140705,
        -0.01311484,
        0.04177916,
        -0.10178443,
        -0.21569761,
        0.01565909,
        -0.27418905,
        -0.03551064,
        0.02892201,
        0.05344915,
        -0.05026234,
        0.18413039,
        -0.11663553,
        0.0162466,
        -0.16556253,
        -0.04830382,
        0.24141434,
        0.09317031,
        0.00835115,
        0.11408831,
        0.10949991,
        -0.03641678,
        -0.14478094,
        0.0234874,
        -0.07348802,
        0.14804239,
        -0.23464277,
        0.01217727,
        0.00439172,
        -0.20313738,
        0.09017244,
        0.08452561,
        0.0044375,
        0.09312328
    ],
    uncertain_points: [
        -5.19705708,
        -5.93972658,
        -5.80388019,
        -5.60649881,
        -5.33858942,
        -5.78393615,
        -5.46448817,
        -5.47783211,
        -5.46351964,
        -5.85046429,
        5.53306927,
        5.97337406,
        5.42585752,
        5.26166777,
        5.71613688,
        5.7483573,
        5.14065437,
        5.6941099,
        5.26782224,
        5.48879995
    ],
    uncertain_labels: [
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        -1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1
    ],
    opt_layer1_w: [
        [-0.3], [-0.3]
    ],
    opt_layer1_b: [
        -1.471708721550612, 1.4638299054171822
    ],
    opt_layer3_w: [
        [
            -3.4756037730352953, -3.1951265117983656
        ],
        [
            -0.6023875694498428, 0.742082606972636
        ],
        [
            3.2691245346279794, 2.639303322222997
        ],
        [
            0.6001228460411082, 1.5988685131936045
        ]
    ],
    opt_layer3_b: [
        -0.4959376942683454, -0.38383011398703676, 0.1385379213238358, 0.14474274177948032
    ],
    opt_layer5_w: [
        [
            -0.7608457857739974, -3.807077771966103, 0.15964555671290204, 0.4316940153554302
        ],
        [
            -0.46029527392239034, 0.499362627227224, 0.26215741516903984, 0.6087584334472715
        ],
        [
            -0.12003663770954856, -2.070047029632726, -0.8253090796194713, -0.5211260899153192
        ],
        [
            1.1497913505525421, 3.1232664390054965, 0.31466460121428946, -1.1103448335850838
        ]
    ],
    opt_layer5_b: [
        -0.09954752198229085, -0.20782723076897178, 1.0460388498407667, -0.6316497703555812
    ],
    opt_layer7_w: [
        [0.16424348634195116, -0.6067898480353261, -1.0202767210893393, -0.7873295687436086]
    ],
    opt_layer7_b: [0.1996533593619645],
    opt_layer1_m: [
        [0.02491344], [0.70068589], [0.73497035], [0.37084156], [0.46227552]
    ],
    opt_layer3_m: [
        [
            0.8605093, 0.56943044, 0.75807505, 0.73135307, 0.61638576
        ],
        [
            0.84032619, 0.06090076, 0.82376058, 0.65278433, 0.72836285
        ],
        [
            0.49023495, 0.19951847, 0.72628287, 0.54000413, 0.23391163
        ],
        [
            0.91093786, 0.2910384, 0.59279053, 0.02344848, 0.62066502
        ],
        [
            0.5943032, 0.42353264, 0.02742323, 0.72795442, 0.61406886
        ]
    ],
    opt_layer5_m: [
        [
            0.08142791, 0.08166483, 0.89699322, 0.69682886, 0.24802572
        ],
        [
            0.58751603, 0.88306983, 0.13189556, 0.21079546, 0.43188023
        ],
        [
            0.27004019, 0.36034301, 0.21532768, 0.8946827, 0.21664912
        ],
        [
            0.09661466, 0.18388527, 0.5926203, 0.03219017, 0.04639328
        ],
        [
            0.27394105, 0.15923244, 0.21011788, 0.39390163, 0.46418013
        ]
    ],
    opt_layer7_m: [
        [0.2637135, 0.51581102, 0.91675227, 0.30530062, 0.15048551]
    ],
    seeds: [
        [
            -0.10546053, 0.64185363, 0.01085238
        ],
        [
            0.2023968, 0.87036015, 0.05225535
        ],
        [
            0.53764036, 0.67859313, -0.05827171
        ],
        [
            -1.19854575, -0.92250938, 0.13579477
        ],
        [
            -0.44016375, -0.47246149, -0.15495257
        ],
        [
            1.06442054, -1.08449271, 0.01245821
        ],
        [
            1.18639015, 0.03213133, 0.11171263
        ],
        [
            1.52207574, 0.44376529, 0.09640397
        ],
        [
            -1.15038849, 0.99079206, 0.07442777
        ],
        [
            -0.63797049, 0.00673246, 0.086348
        ]
    ],
    seeds_uncertainty: [[ 0.02370585,  0.03791983,  0.07134828,  0.01213727,  0.09210071,
         0.05630587,  0.02030575,  0.06405349,  0.09740969,  0.04553051,
         0.06144004,  0.05500488,  0.03663104,  0.03875626,  0.02782623,
         0.02049063,  0.02377722,  0.07885224,  0.03503457,  0.05094443],
       [ 0.0244537 ,  0.04978678,  0.08253896,  0.03455988,  0.03488104,
         0.06504549,  0.05478446,  0.01043211,  0.05798564,  0.08610209,
         0.0293575 ,  0.0398928 ,  0.04468857,  0.0065648 ,  0.07063575,
         0.00422891,  0.03357309,  0.06478488,  0.03815334,  0.03244415],
       [ 0.01775185,  0.05790335,  0.09164285,  0.07230707,  0.03169147,
         0.02788635,  0.00493064,  0.02589584,  0.05840729,  0.04542756,
         0.040156  ,  0.00546374,  0.04825252,  0.0288124 ,  0.06716549,
         0.05377914,  0.01749499,  0.02023049,  0.07803814,  0.00035399],
       [ 0.03240361,  0.03169879,  0.02116075,  0.01030562,  0.06796864,
         0.06675942,  0.07097194,  0.02332516,  0.09644931,  0.01574815,
         0.01427283,  0.04917373,  0.07708881,  0.05837554,  0.06712282,
         0.01718021,  0.07221741,  0.05705271,  0.0696481 ,  0.09558135],
       [ 0.00436963,  0.08205679,  0.09599557,  0.04302003,  0.01441032,
         0.02370241,  0.04662985,  0.00270751,  0.07649718,  0.04142145,
         0.05857539,  0.0746838 ,  0.05854838,  0.00983375,  0.01364313,
         0.09070499,  0.03679051,  0.06967138,  0.05724658,  0.0283056 ],
       [ 0.05573778,  0.06524219,  0.0290646 ,  0.04667832,  0.02662817,
         0.01013002,  0.01370063,  0.02469926,  0.03020221,  0.00514979,
         0.01162886,  0.0792376 ,  0.02448556,  0.09086889,  0.06735263,
         0.02762044,  0.01897449,  0.00219315,  0.04250546,  0.06297238],
       [ 0.00469328,  0.06342714,  0.05969792,  0.0723722 ,  0.02829784,
         0.02986118,  0.03373996,  0.08497875,  0.08192567,  0.03338716,
         0.06452215,  0.00719363,  0.05218378,  0.07171803,  0.08902636,
         0.02133107,  0.01642164,  0.00587925,  0.05342278,  0.00631698],
       [ 0.04905383,  0.09603539,  0.08609481,  0.02970892,  0.06332615,
         0.03648009,  0.00538166,  0.00306987,  0.04445776,  0.06449624,
         0.0620649 ,  0.05262547,  0.03930319,  0.05817366,  0.09929711,
         0.03350043,  0.02816791,  0.01687374,  0.00490362,  0.08670064],
       [ 0.03364336,  0.04555135,  0.02723903,  0.06749827,  0.05051359,
         0.03904008,  0.0211973 ,  0.02590128,  0.07028431,  0.01052841,
         0.06972493,  0.0996747 ,  0.07761913,  0.06778206,  0.02368568,
         0.05269789,  0.02654503,  0.06647225,  0.05978102,  0.03333514],
       [ 0.01922595,  0.08530632,  0.05543195,  0.04976065,  0.05742006,
         0.00882051,  0.0391238 ,  0.00820364,  0.08411321,  0.00070119,
         0.07219015,  0.0222949 ,  0.0312779 ,  0.05891151,  0.03314546,
         0.01647779,  0.0325943 ,  0.08789067,  0.06773708,  0.02892418]]
};

// scales

var inv_x_scale = d3.scaleLinear().domain([0, param.w_loss]).range(param.loss_domain_x);
inv_x_scale.clamp(true);

var inv_y_scale = d3.scaleLinear().domain([param.h_loss, 0]).range(param.loss_domain_y);
inv_y_scale.clamp(true);

var divergence_fill_color = d3.scaleLinear().domain([-50, 0]).interpolate(function() {
    return d3.interpolateRdYlGn;
});

var train_contour_color = d3.scaleLinear().domain([-2.5, 0.05]).interpolate(function() {
    return d3.interpolateSpectral;
});

var train_contour_scale = d3.contours().size([param.n, param.m]).thresholds(d3.range(-0.05, 2.5, 0.05));

var valid_contour_color = d3.scaleLinear().domain([-20, 0.5]).interpolate(function() {
    return d3.interpolateSpectral;
});
var valid_contour_scale = d3.contours().size([param.n, param.m]).thresholds(d3.range(-0.5, 20, 0.5));
